# Rip Usage Guide - Bun First! üöÄ

Rip is designed to be **dead simple** to use. One import, and you're compiling Rip to JavaScript.

## üéØ The Simplest Way

```javascript
import { compile } from 'rip'

const js = compile(`
  greet = (name) -> "Hello, #{name}!"
  greet('World')
`)

console.log(js)
// Output: JavaScript string
```

That's it! **Rip source ‚Üí JavaScript string**. No complexity, no ceremony.

## üöÄ For Bun Projects

### Option 1: Use the Plugin (Recommended)

**Setup once** in your `bunfig.toml`:

```toml
[bun]
preload = ["rip/bun"]
```

**Then just import `.rip` files anywhere:**

```typescript
// app.ts
import { greet, calculate } from './utils.rip'

console.log(greet('Bun'))
```

```rip
# utils.rip
export greet = (name) -> "Hello from Rip, #{name}!"
export calculate = (x, y) -> x * y + 42
```

**That's it!** No build step, no compilation, just import and go.

### Option 2: Compile Dynamically

```javascript
import { compile } from 'rip'

const ripSource = await Bun.file('./app.rip').text()
const js = compile(ripSource)

// Use the compiled JavaScript
eval(js)
```

## üåê For Browsers

### Option 1: Auto-Execute Tags (Easiest!)

```html
<!DOCTYPE html>
<html>
<head>
  <!-- Include the browser module once -->
  <script type="module" src="./node_modules/rip/lib/rip/browser.js"></script>
</head>
<body>
  <!-- Write Rip code anywhere! It runs automatically. -->
  <script type="text/rip">
    x = (y for y in [2..5] when y isnt 3)
    console.log 'Result:', x

    # Update the DOM
    document.body.innerHTML += "<p>Numbers: #{x.join(', ')}</p>"
  </script>

  <script type="text/rip">
    # You can have multiple script tags
    greet = (name) -> "Hello, #{name}!"
    console.log greet('Rip')
  </script>
</body>
</html>
```

See [BROWSER_TAGS.md](./BROWSER_TAGS.md) for complete documentation.

### Option 2: Import and Run

```html
<script type="module">
  import Rip from './node_modules/rip/lib/rip/browser.js'

  // Compile Rip to JavaScript
  const js = Rip.compile(`
    greet = (name) -> "Hello, #{name}!"
    console.log greet('Browser')
  `)

  // Run it
  eval(js)
</script>
```

### Option 3: Run Directly

```html
<script type="module">
  import Rip from './node_modules/rip/lib/rip/browser.js'

  // Run Rip code directly (compiles and executes)
  Rip.run(`
    console.log 'Hello from Rip!'

    # Async works too!
    data = await fetch('/api/users')!
    users = await data.json()!
    console.log 'Users:', users
  `)
</script>
```

### Option 4: Load External Files

```html
<script type="module">
  import Rip from './node_modules/rip/lib/rip/browser.js'

  // Load and run a .rip file
  await Rip.load('./app.rip')
</script>
```

## üì¶ Available Imports

### Browser API (`rip/browser`)

**Auto-executes `<script type="text/rip">` tags:**

```html
<script type="module" src="rip/browser.js"></script>

<script type="text/rip">
  console.log 'This runs automatically!'
</script>
```

**Plus full programmatic API:**

```javascript
import Rip from 'rip/browser'

Rip.compile(code)  // Compile to JS
Rip.run(code)      // Run directly
await Rip.load(url) // Load and run file
```

Perfect for playgrounds, demos, and quick prototypes.

### Core Compiler API (`rip`)

```javascript
import { compile } from 'rip'

// Simple compilation (returns JavaScript string)
const js = compile(source)

// With source maps (returns object)
const result = compile(source, { sourceMap: true, filename: 'app.rip' })
console.log(result.js)         // JavaScript string
console.log(result.sourceMap)   // SourceMap object
console.log(result.v3SourceMap) // V3 source map JSON
```

**Advanced features:**

```javascript
import Rip from 'rip'

// Tokenize
const tokens = Rip.tokens(source)

// Parse to AST
const ast = Rip.nodes(source)

// Version
console.log(Rip.VERSION)
```

### Browser/Bun API (`rip/browser`)

Enhanced API with `run()` and `load()`:

```javascript
import Rip from 'rip/browser'

// Compile
const js = Rip.compile(source)

// Run directly
const result = Rip.run(source)

// Load from file/URL
await Rip.load('./app.rip')
```

## ‚öôÔ∏è Compilation Options

All compile functions accept these options:

```javascript
compile(source, {
  bare: true,          // Don't wrap in function (default: true)
  sourceMap: false,    // Generate source map (default: false)
  filename: 'app.rip', // Source filename
  inlineMap: false,    // Inline source map in output
  header: false,       // Add "Generated by Rip" comment
})
```

## üé® Language Features

```rip
# Clean syntax
greet = (name) -> "Hello, #{name}!"

# Async with ! suffix
data = fetch(url)!
result = processData(data)!

# Array comprehensions
squares = (x * x for x in [1, 2, 3, 4, 5])

# Destructuring
{a, b, c} = object
[first, ...rest] = array

# Classes
class Animal
  constructor: (@name) ->
  speak: -> "#{@name} makes a sound"

# Ruby-style regex matching
email =~ /^([^@]+)@(.+)$/
username = _[1]  # Access match groups via _

# Bracket regex indexing
domain = email[/@(.+)$/] and _[1]

# Null safety
userName = user?.profile?.name ? 'Anonymous'

# Everything is an expression
result = if condition then 'yes' else 'no'
```

## üîß Build Tools Integration

### Vite Plugin (Coming Soon)

```javascript
// vite.config.js
import rip from 'vite-plugin-rip'

export default {
  plugins: [rip()]
}
```

### Webpack Loader (Coming Soon)

```javascript
// webpack.config.js
module.exports = {
  module: {
    rules: [
      {
        test: /\.rip$/,
        use: 'rip-loader'
      }
    ]
  }
}
```

### esbuild Plugin (Coming Soon)

```javascript
import ripPlugin from 'esbuild-plugin-rip'

await build({
  plugins: [ripPlugin()]
})
```

## üéØ Best Practices

### For Libraries

Compile Rip to JavaScript and ship the compiled output:

```json
{
  "name": "my-library",
  "main": "./dist/index.js",
  "scripts": {
    "build": "rip -c -o dist src/*.rip"
  }
}
```

### For Applications (Bun)

Use the plugin and import `.rip` files directly:

```toml
# bunfig.toml
[bun]
preload = ["rip/bun"]
```

```javascript
// No compilation step needed!
import { app } from './app.rip'
app.listen(3000)
```

### For Web Apps

Compile during build, or use browser API for dynamic compilation:

```javascript
// Build step
import { compile } from 'rip'
const js = compile(await Bun.file('app.rip').text())
await Bun.write('dist/app.js', js)

// Or dynamic in browser
import Rip from 'rip/browser'
await Rip.load('./components/Header.rip')
```

## üìö Examples

See the [`examples/`](./examples/) directory for complete working examples:

- **simple-api.js** - Basic compilation example
- **browser-example.html** - Browser usage patterns
- **bun-example/** - Bun project with direct .rip imports

## üöÄ Why Bun First?

1. **Native Performance** - Bun's plugin system is blazing fast
2. **Zero Configuration** - One line in bunfig.toml
3. **Seamless Integration** - Import .rip files like .ts or .js
4. **Hot Reload** - Changes reflect instantly
5. **Future-Proof** - Bun is the future of JavaScript runtimes

## ü§ù Contributing

Issues and PRs welcome! Please follow the existing code style.

## üìÑ License

MIT - See LICENSE file for details
